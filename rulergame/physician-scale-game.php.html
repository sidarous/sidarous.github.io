<!doctype html>
<html>
<head>
    
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta charset="UTF-8">
    <title>The Physician Scale Game - Practice Physician Mechanical Scale Reading</title>
	
<meta name="description" content="Practice reading and using a physician weight scale with this interactive game! Learn to measure weight accurately.">
<meta property="og:title" content="The Physician Scale Game - Practice Physician Mechanical Scale Reading">
<meta property="og:description" content="Practice reading and using a physician weight scale with this interactive game! Learn to measure weight accurately.">
<meta property="og:image" content="https://www.rulergame.net/images/og-physician-scale-game.png">
<meta property="og:url" content="https://www.rulergame.net/physician-scale-game.php">
<meta property="og:type" content="website">
<link rel="canonical" href="physician-scale-game.php.html">


    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/site.css">
    <link rel="stylesheet" href="assets/css/animate.min.css">
    <link rel="stylesheet" href="physician-scale/css/weight_scale.css">
    <!-- <link rel="stylesheet" href="css/w3.css"> -->
    
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="gtag/js?id=G-XE0GQQH6FP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XE0GQQH6FP');
</script>
<!-- AdThrive Head Tag Manual -->
<script data-no-optimize="1" data-cfasync="false">
(function(w, d) {
	w.adthrive = w.adthrive || {};
	w.adthrive.cmd = w.
	adthrive.cmd || [];
	w.adthrive.plugin = 'adthrive-ads-manual';
	w.adthrive.host = 'ads.adthrive.com';var s = d.createElement('script');
	s.async = true;
	s.referrerpolicy='no-referrer-when-downgrade';
	s.src = 'https://' + w.adthrive.host + '/sites/6441cbd48ef14750ba9ecca1/ads.min.js?referrer=' + w.encodeURIComponent(w.location.href) + '&cb=' + (Math.floor(Math.random() * 100) + 1);
	var n = d.getElementsByTagName('script')[0];
	n.parentNode.insertBefore(s, n);
})(window, document);
</script>
<!-- End of AdThrive Head Tag -->
    
</head>
<body>
<!-- Navbar -->
<div class="z100">
    <div class="w3-bar w3-pale-green w3-card w3-left-align w3-large">
        <a class="w3-bar-item w3-button w3-padding-large rulergame-dark-green" href="javascript:void(0);" onclick="toggleNavMenu()" title="Toggle Navigation Menu">Menu</a>
        <div id="topBanner"><a href="index.htm"><img src="images/rulergame.gif" id="topBannerImage" alt="The Ruler Game - Learn to read a ruler"></a></div>
    </div>
    <div id="NavMenu" class="w3-dropdown-content w3-bar-block w3-border w3-large rulergame-dark-green z100">
	<a href="index.htm" class="w3-bar-item w3-button w3-padding-large">Home</a>
        <a href="javascript:void(0);" class="w3-bar-item w3-button w3-padding-large" onclick="toggleCategory('measuringGames')">Measuring Games</a>
        <div id="measuringGames" class="w3-hide w3-bar-block rulergame-submenu">
            <a href="new-english-ruler-game.php.html" class="w3-bar-item w3-button w3-padding-large">Inch Ruler Game</a>
            <a href="new-metric-ruler-game.php.html" class="w3-bar-item w3-button w3-padding-large">Metric Ruler Game</a>
            <a href="micrometer-game.php.html" class="w3-bar-item w3-button w3-padding-large">Micrometer Game</a>
            <a href="metric-micrometer-game.php.html" class="w3-bar-item w3-button w3-padding-large">Metric Micrometer Game</a>
			<a href="dial-caliper-game.php.html" class="w3-bar-item w3-button w3-padding-large">Dial Caliper Game</a>
			<a href="vernier-caliper-game.php.html" class="w3-bar-item w3-button w3-padding-large">Vernier Caliper Game</a>
			<a href="graduated-cylinder-game.php.html" class="w3-bar-item w3-button w3-padding-large">Graduated Cylinder Game</a>
			<a href="architectural-scale-game.php.html" class="w3-bar-item w3-button w3-padding-large">Architectural Scale Game</a>
			<a href="machinist-ruler-game.php.html" class="w3-bar-item w3-button w3-padding-large">Machinist Ruler Game</a>
			<a href="triple-beam-balance-game.php.html" class="w3-bar-item w3-button w3-padding-large">Triple Beam Balance Game</a>
        </div>
        <a href="javascript:void(0);" class="w3-bar-item w3-button w3-padding-large" onclick="toggleCategory('timeGames')">Time and Temperature Games</a>
        <div id="timeGames" class="w3-hide w3-bar-block rulergame-submenu">
            <a href="clock-game.php.html" class="w3-bar-item w3-button w3-padding-large">Clock Game</a>
            <a href="military-time-game.php.html" class="w3-bar-item w3-button w3-padding-large">Military Time Game</a>
			<a href="thermometer-game.php.html" class="w3-bar-item w3-button w3-padding-large">Thermometer Reading Game</a>
            <a href="temperature-conversion-game.php.html" class="w3-bar-item w3-button w3-padding-large">Temperature Conversion Game</a>
        </div>
        <a href="javascript:void(0);" class="w3-bar-item w3-button w3-padding-large" onclick="toggleCategory('moneyGames')">Money & Life Games</a>
        <div id="moneyGames" class="w3-hide w3-bar-block rulergame-submenu">
            <a href="money-game.php.html" class="w3-bar-item w3-button w3-padding-large">Money Counting Game</a>
            <a href="shopping-money-counting-game.php.html" class="w3-bar-item w3-button w3-padding-large">Shopping Money Counting Game</a>
            <a href="counting-back-change-game.php.html" class="w3-bar-item w3-button w3-padding-large">Counting Back Change Game</a>
			<a href="blood-pressure-game.php.html" class="w3-bar-item w3-button w3-padding-large">Blood Pressure Game</a>
			<a href="stadiometer-game.php.html" class="w3-bar-item w3-button w3-padding-large">Stadiometer Game</a>
			<a href="physician-scale-game.php.html" class="w3-bar-item w3-button w3-padding-large">Physician Scale Game</a>
			<a href="cooking-conversions-game.php.html" class="w3-bar-item w3-button w3-padding-large">Cooking Conversions Game</a>
        </div>
    </div>
</div>


<div id="mainBodyContent" class="w3-container w3-margin-top">

    <div class="container-fluid setting-section">
      
      
        <div class="vertical-center">
            <!-- <button class="btn btn-game-start" id= "btnStart">
            Play Game
            </button> -->
            <div id="buttonBar">
            <input type="button" id="btnStart" value="Play Game">
            <input type="button" id="btnSettings" value="Settings">
            </div>
        </div>
      
        
        <div id="questionBar">
            <div id="txtQuestion"><span>&nbsp;</span></div>
        </div>
  
        <div id="preferencesBox" class="w3-card w3-pale-yellow w3-border w3-border-yellow">
            <span onclick="$('#preferencesBox').slideToggle();" class="w3-button w3-display-topright">X</span>
            <header class="w3-container w3-yellow">
            <h5>Settings</h5>
            </header>
            <div class="w3-padding-small">
            <div id="timerBox" class="w3-row">
                <div class="w3-col s6 w3-right-align rulergame-align-vert"><strong>Timer:&nbsp;</strong></div>
                <div class="w3-col s6">
                    <select id="stgTimer" class="w3-select w3-border">
                        <option value="On" selected="">On</option>
                        <option value="Off">Off</option>
                    </select>  
                </div>
            </div>
            <div id="soundsBox" class="w3-row">
                <div class="w3-col s6 w3-right-align rulergame-align-vert"><strong>Sounds:&nbsp;</strong></div>
                <div class="w3-col s6">
                    <select id="stgSounds" class="w3-select w3-border">
                        <option value="On" selected="">On</option>
                        <option value="Off">Off</option>
                    </select>  
                </div>
            </div>
            <div id="unitSelection" class="w3-row">
                <div class="w3-col s6 w3-right-align rulergame-align-vert"><strong>Unit:&nbsp;</strong></div>
                <div class="w3-col s6">
                    <select id="stgUnit" class="w3-select w3-border">
                        <option value="lb" selected="">lb</option>
                        <option value="kg">kg</option>
                    </select>  
                </div>
            </div>
              
            
            </div>
            <!-- <div id="rulerLengthMessage" class="w3-row"></div> -->
        </div>
        
  
    </div>
    
</div>
    
  
<div class="canvas-area">

    <div id="canvasArea">
        <canvas id="playerCanvas"></canvas>
        <!-- <canvas id="rulerCanvas" width="900" height="500" style="border:2px solid #000000; background-color:#fff"></canvas> -->
        <canvas id="myCanvas" width="1000" height="500" style="border:2px solid #000000; background-color:#fff"></canvas>
        <!-- <canvas id="myCanvas" style="border: 1px solid #c3c3c3;">
            Your browser does not support the HTML5 canvas tag.
        </canvas> -->
      
        <div id="strikeBoard"><span></span></div>
        <div id="cheerBoard"><div class='cheer animated rubberBand'>123</div></div>

        <div id="detailedControl" class="w3-container w3-padding">
            <div class="w3-row">
                <div id="verniersmall" class="">
                    <div class="w3-row number-input">
                        
                        <div class="w3-col" id="smallsmall">
                            <div id="labelsmallsmall" class="w3-half" style="text-align: right; padding-right: 10px;"><b>Small weight indicator</b></div>
                            <div class="w3-half">
                            <button class="spinner decrement" id="btnsmalldecrement">-</button>
                                <input id="smallsmallControl" name="sleevemain" value="00000" onchange="DrawSleeveMainChange()">
                            <button class="spinner increment" id="btnsmallincrement">+</button> 
                            </div>
                        </div>
						
						<div class="w3-col" id="largesmall">
                            <div id="labellargesmall" class="w3-half" style="text-align: right; padding-right: 10px;"><b>Large weight indicator</b></div>
                            <div class="w3-half">
                            <button class="spinner decrement" id="btnlargedecrement">-</button>
                                <input id="largesmallControl" name="sleevemain" value="00000" onchange="DrawSleeveMainChange()">
                            <button class="spinner increment" id="btnlargeincrement">+</button> 
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div> 
    </div>    
</div>

<div id="resultsBar" class="w3-container">
    <div class="w3-row">
        <div id="submitColumn" class="w3-third w3-center"> 
            <input type="button" id="btnSubmit" value="Submit Answer">
			<br>
        </div>
        <div id="displayBoard" class="w3-twothird w3-center">
            <div id="scoreColumn"><div id="txtScore"></div><div class="resultsBarLabel">SCORE</div></div>
            <div id="timerColumn"><canvas id="timerCanvas"></canvas><div class="resultsBarLabel">TIME</div></div>
            <div id="levelColumn"><canvas id="levelCanvas"></canvas><div class="resultsBarLabel">LEVEL</div></div>
            <div id="strikesColumn"><div id="txtStrikes"></div><div class="resultsBarLabel">STRIKES</div></div>                
        </div>
    </div>
    
</div>

<div id="instructionsBox" class="w3-container">
    <h1 align="center">The Physician Scale Game - Practice Physician Mechanical Scale Reading</h1>
	
                    <h2>Instructions:</h2>
                    <ul class="w3-ul">
                        <li>This game makes practicing your physician or doctor's weight scale reading skills both fun and easy.</li>
                        <li>You can play this game using either a mouse or a touchscreen.</li>
                        <li>Click the <strong>Play Game</strong> button to start.</li>
                        <li>First, you'll need to balance the scale. Using your mouse or finger, click/tap and hold the poise weight on either the small or large weight indicator, then slide it along the beams to balance the object. It's usually best to start with the poise on the large weight indicator.</li>
						<li>If you're unable to balance the scale by sliding, you can use the plus and minus icons below the physician mechanical beam scale to adjust the poise weights.</li>
                        <li>When the scale is balanced, the pointer will change to red. A zoomed-in view of the balance bar and window is displayed in the bottom-right corner of the game.</li>
						<li>Next, click on the numbers below the physician's balance or use your keyboard to enter the weight. For easier reading, a zoomed-in view of the small weight indicator is displayed in the top-right corner of the game.</li>
						<li>After entering the weight, click or tap the 'Submit Answer' button.</li>
                        <li>For each correct answer, you will earn points. Your score is displayed on the left side of the Results Bar, located below the balance.</li>
                        <li>Points are awarded based on the following table.
                              <table class="w3-table w3-bordered">
                                <tr><th>Level</th><th>Time Limit</th><th>Points</th></tr>
                                <tr><td>1</td><td>40 seconds</td><td>10</td></tr>
                                <tr><td>2</td><td>36 seconds</td><td>20</td></tr>
                                <tr><td>3</td><td>32 seconds</td><td>30</td></tr>
                                <tr><td>4</td><td>28 seconds</td><td>40</td></tr>
                                <tr><td>5</td><td>24 seconds</td><td>50</td></tr>
                                <tr><td>6</td><td>20 seconds</td><td>60</td></tr>
                                <tr><td>7</td><td>16 seconds</td><td>70</td></tr>
                                <tr><td>8</td><td>12 seconds</td><td>80</td></tr>
								<tr><td>8</td><td>8 seconds</td><td>90</td></tr>
								<tr><td>8</td><td>4 seconds</td><td>100</td></tr>
                              </table></li>
                        <li>For every 5 correct measurements, you advance to the next level. Your current level is displayed in the Results Bar below the doctor's weight balance.</li>
                        <li>The timer is shown to the right of the score in the Results Bar. As time passes, the bar gradually shortens.</li>
                        <li>If you have not submitted a measurement when the time runs out, you will receive a strike.</li>
                        <li>For each incorrect answer, you will receive a strike. After three strikes, your game is over. The number of strikes you have received is displayed on the right side of the Results Bar.</li>
                        <li>Click the <em><strong>Settings</strong></em> button to adjust your preferences for the game.
                            <ul>
                                <li><strong>Timer:</strong> The default setting is On. Select Off for unlimited time to submit your answer.</li>
                                <li><strong>Sounds:</strong> The default setting is On. Select Off to mute all game sounds.</li>
								<li><strong>Unit:</strong> The default unit is pounds (lb). Pound markings are on the top of the small and large weight indicators. You can also select kilograms (kg).</li>
                                <li>All settings will revert to their default values, and your score will reset if you refresh your browser.</li>
                            </ul></li>
                    </ul>
	
</div>
  
<br>
  
<footer class="w3-container w3-padding rulergame-dark-green">  
            <div class="w3-row-padding">

              <div class="w3-third">
                <h3>MEASURING GAMES</h3>
                <ul class="w3-ul">
                  <li class="w3-padding-16">
                    <a href="new-english-ruler-game.php.html" class="w3-text-white w3-hover-opacity w3-large rulergame-no-underline">New Inch Ruler Game</a><br>
                  </li>
				  <li class="w3-padding-16">
                    <a href="new-metric-ruler-game.php.html" class="w3-text-white w3-hover-opacity w3-large rulergame-no-underline">New Metric Ruler Game</a><br>
                  </li>
                  <li class="w3-padding-16">
                    <a href="v2-standard-english-ruler-game.php.html" class="w3-text-white w3-hover-opacity w3-large rulergame-no-underline">Original Inch Ruler Game</a><br>
                  </li>
				  <li class="w3-padding-16">
                    <a href="micrometer-game.php.html" class="w3-text-white w3-hover-opacity w3-large rulergame-no-underline">Inch Mictometer Game</a><br>
                  </li>
				  <li class="w3-padding-16">
                    <a href="metric-micrometer-game.php.html" class="w3-text-white w3-hover-opacity w3-large rulergame-no-underline">Metric Micrometer Game</a><br>
                  </li>
                  <li class="w3-padding-16">
                    <a href="v2-metric-ruler-game.php.html" class="w3-text-white w3-hover-opacity w3-large rulergame-no-underline">Original Metric Ruler Game</a><br>
                  </li>
				  <li class="w3-padding-16">
                    <a href="dial-caliper-game.php.html" class="w3-text-white w3-hover-opacity w3-large rulergame-no-underline">Dial Caliper Game</a><br>
                  </li>
				  <li class="w3-padding-16">
                    <a href="vernier-caliper-game.php.html" class="w3-text-white w3-hover-opacity w3-large rulergame-no-underline">Vernier Caliper Game</a><br>
                  </li>
                  <li class="w3-padding-16">
                    <a href="graduated-cylinder-game.php.html" class="w3-text-white w3-hover-opacity w3-large rulergame-no-underline">Graduated Cylinder Game</a><br>
                  </li>
				  <li class="w3-padding-16">
                    <a href="architectural-scale-game.php.html" class="w3-text-white w3-hover-opacity w3-large rulergame-no-underline">Architectural Scale Game</a><br>
                  </li>
				  <li class="w3-padding-16">
                    <a href="machinist-ruler-game.php.html" class="w3-text-white w3-hover-opacity w3-large rulergame-no-underline">Machinist Ruler Game</a><br>
                  </li>
				  <li class="w3-padding-16">
                    <a href="triple-beam-balance-game.php.html" class="w3-text-white w3-hover-opacity w3-large rulergame-no-underline">Triple Beam Balance Game</a><br>
                  </li>
                </ul>
              </div>

              <div class="w3-third">
                <h3>TIME AND TEMPERATURE GAMES</h3>
                <ul class="w3-ul">
                  <li class="w3-padding-16">
                    <a href="clock-game.php.html" class="w3-text-white w3-hover-opacity w3-large rulergame-no-underline">Clock Game</a><br>
                  </li>
				  <li class="w3-padding-16">
                    <a href="military-time-game.php.html" class="w3-text-white w3-hover-opacity w3-large rulergame-no-underline">Military Time Game</a><br>
                  </li>
				  <li class="w3-padding-16">
                    <a href="thermometer-game.php.html" class="w3-text-white w3-hover-opacity w3-large rulergame-no-underline">Thermometer Reading Game</a><br>
                  </li>
				  <li class="w3-padding-16">
                    <a href="temperature-conversion-game.php.html" class="w3-text-white w3-hover-opacity w3-large rulergame-no-underline">Temperature Conversion Game</a><br>
                  </li>
				</ul>
				<h3>MONEY AND LIFE GAMES</h3>
				<ul class="w3-ul">
				  <li class="w3-padding-16">
                    <a href="money-game.php.html" class="w3-text-white w3-hover-opacity w3-large rulergame-no-underline">Money Counting Game</a><br>
                  </li>
				  <li class="w3-padding-16">
                    <a href="shopping-money-counting-game.php.html" class="w3-text-white w3-hover-opacity w3-large rulergame-no-underline">Shopping Money Counting Game</a><br>
                  </li>
				  <li class="w3-padding-16">
                    <a href="counting-back-change-game.php.html" class="w3-text-white w3-hover-opacity w3-large rulergame-no-underline">Counting Back Change Game</a><br>
                  </li>
				  <li class="w3-padding-16">
                    <a href="blood-pressure-game.php.html" class="w3-text-white w3-hover-opacity w3-large rulergame-no-underline">Blood Pressure Game</a><br>
                  </li>
				  <li class="w3-padding-16">
                    <a href="stadiometer-game.php.html" class="w3-text-white w3-hover-opacity w3-large rulergame-no-underline">Stadiometer Game</a><br>
                  </li>
				  <li class="w3-padding-16">
                    <a href="physician-scale-game.php.html" class="w3-text-white w3-hover-opacity w3-large rulergame-no-underline">Physician Scale Game</a><br>
                  </li>
				  <li class="w3-padding-16">
                    <a href="cooking-conversions-game.php.html" class="w3-text-white w3-hover-opacity w3-large rulergame-no-underline">Cooking Conversions Game</a><br>
                  </li>
                </ul>
              </div>

              <div class="w3-third">
                <h3>CONTACT ME</h3>
                  <p class="w3-xxlarge w3-margin-top w3-margin-bottom">
                    <a href="privacy-policy.php.html#contact" class="w3-text-white w3-hover-opacity"><img src="contact-button.png" alt="Contact button"></a>
                    <a href="https://www.facebook.com/RulerGame/" class="w3-text-white w3-hover-opacity" target="_blank"><img src="facebook-button.png" alt="Facebook button"></a>
                  </p>                   
                  <p>Spears Technologies, Inc.<br>
                    Attn: The Ruler Game<br>
                    576 N. Birdneck Rd. #178<br>
                    Virginia Beach, VA 23451</p>
              </div>

            </div>
<div class="rulergame-dark-green w3-center w3-padding w3-border-top">Copyright &copy; 2025  by RulerGame.net and Ricky D. Spears. All Rights Reserved. <a href="privacy-policy.php.html" class="w3-text-white w3-hover-opacity">Privacy Policy</a><br><br><br></div>
</footer>

<script src="assets/js/jquery.min.js">  </script>
<script src="assets/js/jquery-3.6.0.min.js">  </script>
<script src="assets/js/bootstrap.min.js">  </script>
<script src="physician-scale/js/weight_scale.js">  </script>
<script type='text/javascript'>
    /*drawing offset*/
    var scale;
    var xOffset;
    var yOffset;
    var dragMode = 0; //0 == none, 1 = world, 2 = vernier, 3 = object

    var prev_mx, prev_my; //prev mouse positions
    // var bgColor = "rgb(0,64,84)";
    var bgColor = "rgb(255,255,255)";
    var fgColor = "orange";//rgb(255,255,255)";
    const scaleColor = "black";

    var loadedItems = 0;
    const itemsToLoad = 10;
    
    var imgBkGnd = new Image();
    imgBkGnd.src = "https://www.rulergame.net/physician-scale/images/bkground.png"
    imgBkGnd.onload = itemloaded;
	var imgBkGndMagnify = new Image();
    imgBkGndMagnify.src = "https://www.rulergame.net/physician-scale/images/bkground-magnify.png"
    imgBkGndMagnify.onload = itemloaded;
	var imgRulerBase = new Image();
    imgRulerBase.src = "https://www.rulergame.net/physician-scale/images/ruler-base.png"
    imgRulerBase.onload = itemloaded;
    var imgTailNormal = new Image();
    imgTailNormal.src = "https://www.rulergame.net/physician-scale/images/tail-normal.png"
    imgTailNormal.onload = itemloaded;
	var imgTailRight = new Image();
    imgTailRight.src = "https://www.rulergame.net/physician-scale/images/tail-right.png"
    imgTailRight.onload = itemloaded;
	var imgTailMagnify = new Image();
    imgTailMagnify.src = "https://www.rulergame.net/physician-scale/images/tail-magnify.png"
    imgTailMagnify.onload = itemloaded;
	var imgTailMagnifyRight = new Image();
    imgTailMagnifyRight.src = "https://www.rulergame.net/physician-scale/images/tail-magnify-right.png"
    imgTailMagnifyRight.onload = itemloaded;
	var imgHandSmall = new Image();
    imgHandSmall.src = "https://www.rulergame.net/physician-scale/images/small-hand.png"
    imgHandSmall.onload = itemloaded;
	var imgHandLarge = new Image();
    imgHandLarge.src = "https://www.rulergame.net/physician-scale/images/large-hand.png"
    imgHandLarge.onload = itemloaded;
    
    var imgTail = new Image();
    imgTail.src = "https://www.rulergame.net/physician-scale/images/tail.png"
    imgTail.onload = itemloaded;
    
	var cr; 

    const scaleOriginX = 67; //jaw Left position
    const scaleOriginY0 = 105; //105; //scale top position
    const scaleOriginY = 205; //162; //scale bottom position
    const offsetOriginX = 12; //distance of scale origin level from scaleOriginX
    const vernierOriginX = 55; //distance of vernier origin in pixel in vernier.png
    const vernierOriginY = 204; //161;

    const rulerWidthPixel = 915;
    const vernierMajorTickLengthPixels = 10;
    const vernierMinorTickLengthPixels = 6;
    
    const vernierScaleHeightPixels = 397; //354;
    const bladeWidthPixel = 716;
    const bladeHeightPixel = 20;
    const rulerMidPointY = 188;

    const unit = "cm";
    
	const mainScaleLengthPixels = 500; // not neccessary
	const mainScaleDivisions = 10; // not neccessary
    const largeScaleLBLengthPixels = 438;
    const largeScaleKGLengthPixels = 520;
    const smallScaleLBLengthPixels = 632;
    const smallScaleKGLengthPixels = 556;
	const largeScaleLBDivisions = 6;
	const largeScaleKGDivisions = 8;
	const smallScaleLBDivisions = 200;
	const smallScaleKGDivisions = 200;
    var largeScaleDivisions = largeScaleLBDivisions;
    var smallScaleDivisions = smallScaleLBDivisions;

    var largeLBUnit = 50;
    var smallLBUnit = 0.25;
    var largeKGUnit = 20;
    var smallKGUnit = 0.1;
    var largeUnit = largeLBUnit;
    var smallUnit = smallLBUnit;

    var msdValue = 0.1;
	var msdValueInch = 0.1; // * 2.54;
    var vernierScaleDivisions = 50;
	var vernierScaleDivisionsForInch = 25;
    var msd_pixels = mainScaleLengthPixels / mainScaleDivisions; // not neccessary
    var vsd_pixels = mainScaleLengthPixels / mainScaleDivisions; // not neccessary
	var small_lb_pixels = smallScaleLBLengthPixels / smallScaleLBDivisions;
	var small_kg_pixels = smallScaleKGLengthPixels / smallScaleKGDivisions;
	var large_lb_pixels = largeScaleLBLengthPixels / largeScaleLBDivisions;
	var large_kg_pixels = largeScaleKGLengthPixels / largeScaleKGDivisions;
    var small_pixels = small_lb_pixels;
    var large_pixels = large_lb_pixels;
	
    var vernierScaleLengthPixels = 50 + vsd_pixels * vernierScaleDivisions + 50 ;
	
    var setUnit = function(unit) {
        if (unit == "lb") {
            largeUnit = 50;
            smallUnit = 0.25;
            small_pixels = small_lb_pixels;
            large_pixels = large_lb_pixels;
            largeScaleDivisions = largeScaleLBDivisions;
            smallScaleDivisions = smallScaleLBDivisions;
        } else if (unit == "kg") {
            largeUnit = 20;
            smallUnit = 0.1;
            small_pixels = small_kg_pixels;
            large_pixels = large_kg_pixels;
            largeScaleDivisions = largeScaleKGDivisions;
            smallScaleDivisions = smallScaleKGDivisions;
        }
    }

    var precision = 3;
    var LC = 0;
    
    var msr = 0; // not neccessary
    var vsr = 0; // not neccessary
	
	var rotate_angle = 6 * Math.PI / 180;
    var isWeightRight = false;
    var input_answer = "0.0";
	var set_input_answer = function(val) {
        var last_num = stgUnit == "lb" ? 100 : 10;
        var last_num_cnt = stgUnit == "lb" ? 2 : 1;
		if (val == "Back") {
			input_answer = "" + (parseInt((parseFloat(input_answer) / 10) * last_num) / last_num).toFixed(last_num_cnt);
		} else {
			input_answer = "" + ((parseFloat(input_answer) * 10 + parseInt(val) / last_num)).toFixed(last_num_cnt);
		}
		
        var max_input_answer = stgUnit == "lb" ? 390 : 180;
		if (parseFloat(input_answer) > max_input_answer) {
			tmp = parseInt(input_answer);
			tmp = tmp - tmp % 1000;
			input_answer = (parseFloat(input_answer) - tmp); //"610.0";
		} else if (parseFloat(input_answer) < 0.0) {
			input_answer = "0.0";
		}
	}
	var large_msr = 0;
    var small_msr = 0;
    var get_total_msr = function() {
        var largeShift = large_pixels * large_msr -
                        large_pixels * ((stgUnit == "lb" && large_msr > largeScaleLBDivisions) ? 0.2 : 0);
        return large_msr * largeUnit -
                largeUnit * ((stgUnit == "lb" && large_msr > largeScaleLBDivisions) ? 0.2 : 0) +
            small_msr * smallUnit;
    }
    var set_large_msr = function(val) {
        var max_val = largeScaleDivisions;
        if (stgUnit == "lb") {
            max_val ++;
        }

        if (val < 0) large_msr = 0;
        else if (val > max_val) large_msr = max_val;
        else large_msr = val;
    }
    var set_small_msr = function(val) {
        if (val < 0) small_msr = 0;
        else if (val > smallScaleDivisions) small_msr = smallScaleDivisions;
        else small_msr = val;
    }

    var zeroError = 0;
	
	var msrInch = 0;
	var vsrInch = 0;
	var zeroErrorInch = 0;
	
    var displayInfo = false;
    var objectWidthPixel = 25;
    var drawSubDivision = false;
    var randomZeroError = true;
    var randomMainScaleDivisions = true;
    var randomVernierScaleDivision = true;
    var randomObjectWidthPixel = true;

    var canvas = document.getElementById("myCanvas");

    let detailsOpenMode = navigator.userAgent;
    let regexp = /android|iphone|kindle|ipad/i;

    let isMobileDevice = regexp.test(detailsOpenMode);

    if(isMobileDevice)
    {
        scale = Math.floor((window.innerWidth/1000)*100)/100;
		console.log("Scale = " + scale);
    }
    else
    {
        scale = 1.0;
    }
     
    var ctx = canvas.getContext("2d");
    ctx.font = "30px Arial";
    xOffset = (canvas.width/*getBaseImage().width*/) / 2; //jaw Left position
    yOffset = (canvas.height) / 2 + 120;
    
	//Add event listeners
    window.addEventListener('resize', function(ev) { return resize(ev); });
    paint();
	
	function itemloaded()
	{
        loadedItems++;
        if(loadedItems == itemsToLoad)
		{
            /*hammertime = new Hammer(document);
            hammertime.get('pinch').set({ enable: true });

            hammertime.on('pinchstart', function(ev) 
			{
                initScale=scale;
            });

            //can use pinch in pinchout separately
            hammertime.on('pinch', function(ev) 
			{
                console.log(ev.type + " scale = " + ev.scale);
                let oldScale=scale;

                let x = ev.center.x/scale;
                let y = ev.center.y/scale;
                scale=initScale*ev.scale;

                xOffset-= x*(scale-oldScale);
                yOffset-= y*(scale-oldScale);

                paint();
            }); */ 
			
			//console.log("Item loaded....");
			var defaultPrevent = function(e){ e.preventDefault() };
			//canvas.addEventListener("touchstart", defaultPrevent);
			//canvas.addEventListener("touchmove" , defaultPrevent);
			canvas.addEventListener("mousedown", defaultPrevent);
			canvas.addEventListener("mousemove", defaultPrevent);
			
			document.addEventListener('touchstart', mousePressed, false);
			document.addEventListener('touchmove', mouseDragged, false); 
			document.addEventListener('touchend', mouseReleased, false);			
			document.addEventListener("mousemove", mouseDragged, false);
			document.addEventListener("mousedown", mousePressed, false);
			document.addEventListener("mouseup", mouseReleased, false);

            canvas.addEventListener("mousewheel", mouseWheelMoved);
            window.addEventListener('keydown', onKeyEvent, false);
			window.addEventListener("orientationchange", resize()); //function() {
				//alert("the orientation of the device is now " + screen.orientation.angle);
			//});
			
        }
		
		

        paint();
    }

    function resize()
	{
        if(window.innerWidth < 10 || window.innerHeight < 10)
			return;
		        
        if(isMobileDevice)
        {
  			scale = Math.floor((window.innerWidth/1000)*100)/100;
			scale = Math.min(scale, 1);
			//scale = (window.innerWidth / imgBkGnd.width);
			//scale = Math.min(window.innerHeight / imgBkGnd.height, window.innerWidth / imgBkGnd.width);
        }
        else
        {
            scale = Math.floor(($(window).width()/1000)*100)/100;
			scale = Math.min(scale, 1);
			console.log("Scale: ", scale);
			//scale = 1.0;
        }
        
        update();
    }

    init();

    function init()
	{
        resize();
    }

    function translateLarge(div)
	{
        set_large_msr(large_msr + div);
        update();
    }

    function translateSmall(div)
    {
        set_small_msr(small_msr + div);
        update();
    }

    function update(ev)
	{
        if(ev) 
			console.log(ev.value.toFixed(2));
        
        $("#largesmallControl").val(large_msr * largeUnit);
        $("#smallsmallControl").val(small_msr * smallUnit);

        if (randomQuestion && get_total_msr().toFixed(1) === randomQuestion.toFixed(1)) {
            isWeightRight = true;
        } else {
            isWeightRight = false;
        }

        paint();
    }


    function paint()
	{
        ctx.lineWidth = 1.5;
        ctx.fillStyle = bgColor;
        ctx.strokeStyle = fgColor;
        ctx.fillRect(0, 0, canvas.width, canvas.height);
		
        ctx.translate(xOffset, yOffset);
        ctx.save();

		ctx.fillStyle = "rgb(0, 0, 0)";
        ctx.font = "bold 10px Arial";
        ctx.fillText("Timer: " + stgTimer,0-xOffset+4,0-yOffset+12);

        //draw Base of gauge
        // ctx.drawImage(imgBkGnd, -imgBkGnd.width / 2, -imgBkGnd.height / 2, imgBkGnd.width * 1, imgBkGnd.height * 1);

        var largeShift = large_pixels * large_msr -
                        large_pixels * ((stgUnit == "lb" && large_msr > largeScaleLBDivisions) ? 0.2 : 0);
        var smallShift = small_pixels * small_msr;

		const majorTickLengthPixels = 9;
		const minorTickLengthPixels = 5;
        let ticklength = 0;
        let labelGap = 8;

        var xDelta = -270;
        var yDelta = -30;
        ctx.translate(xDelta, yDelta);
        ctx.save();        

		// show keyboards and input answer
		var input_val = parseFloat(input_answer).toFixed(stgUnit == "lb" ? 2 : 3);
        console.log(input_answer);
		var input_val_100 = parseInt(input_val / 100);
		var input_val_10 = parseInt((input_val - input_val_100 * 100) / 10);
		var input_val_1 = parseInt(input_val - input_val_100 * 100 - input_val_10 * 10);
		var input_val_point1 = parseInt(((input_val - parseInt(input_val)) * 100).toFixed(0) / 10);
		var input_val_point2 = parseInt((((input_val - parseInt(input_val)) * 100).toFixed(0)) % 10);
        
		ctx.font = '20pt sans-serif';
		
		ctx.fillStyle = "rgb(200, 200, 200)";
		ctx.fillRect(-210, 100, 30, 40);
		ctx.fillRect(-170, 100, 30, 40);
		ctx.fillRect(-130, 100, 30, 40);
		ctx.fillRect(-90, 100, 30, 40);
        if (stgUnit == "lb") {
		    ctx.fillRect(-50, 100, 30, 40);
        }
		
		ctx.fillStyle = "rgb(0, 0, 0)";
		(input_val_100 != 0) && outString(-205, 120, input_val_100.toFixed(0), 0, 0);
		(input_val_100 != 0 || input_val_10 != 0) && outString(-165, 120, input_val_10.toFixed(0), 0, 0);
		outString(-125, 120, input_val_1.toFixed(0), 0, 0);
		outString(-103, 120, ".", 0, 0);
		outString(-85, 120, input_val_point1, 0, 0);
        if (stgUnit == "kg") {
		    outString(-55, 120, "kg", 0, 0);
        } else {
		    outString(-45, 120, input_val_point2, 0, 0);
		    outString(-15, 120, "lb", 0, 0);
        }
		
		for (let i = 0; i <= 9; i ++)
		{
			ctx.fillStyle = "rgb(255, 255, 255)";
			ctx.strokeStyle = "rgb(0, 0, 0)";
			ctx.strokeRect(80 + 50 * i - 10, 100, 40, 40);
			
			ctx.fillStyle = "rgb(0, 0, 0)";
			outString(80 + 50 * i, 120, i, 0, 0);
		}
		ctx.fillStyle = "rgb(255, 255, 255)";
		ctx.strokeStyle = "rgb(0, 0, 0)";
		ctx.strokeRect(80 + 50 * 10 - 10, 100, 40, 40);
		
		ctx.fillStyle = "rgb(0, 0, 0)";
		outString(80 + 50 * 10 - 7, 120 - 3, "←", 0, 0);

        var delta_msr_percent = (get_total_msr().toFixed(1) - (randomQuestion ? randomQuestion.toFixed(1) : 0)) / 610;

		// after rotation

        ctx.rotate(rotate_angle * delta_msr_percent);
		ctx.drawImage(imgRulerBase, -380 - xDelta, -215 - yDelta);
		if (delta_msr_percent == 0)
			ctx.drawImage(imgTailRight, 352 - xDelta, -236 - yDelta);
		else
			ctx.drawImage(imgTailNormal, 352 - xDelta, -236 - yDelta);

        ctx.rotate(-rotate_angle * delta_msr_percent);
		
		// show delta msr
		//ctx.fillStyle = "rgb(255, 255, 255)";
        ctx.font = '12pt sans-serif';
		// if (delta_msr_percent == 0) {
		// 	outString(708, -9, "0", 0, 0);
		// } else if (delta_msr_percent > 0) {
		// 	outString(708, -9, "+", 0, 0);
		// } else if (delta_msr_percent < 0) {
		// 	outString(708, -9, "-", 0, 0);
		// }
		
		ctx.drawImage(imgTail, 673, -237);
		
        // show tail magnify
        var zoom_size = 600;
        var magnify_area_x = 618;
        var magnify_area_y = 10; //-330;
        var magnify_area_width = 140;
        var magnify_area_height = 140;
        var magnify_area_center_x = magnify_area_x + magnify_area_width / 2;
        var magnify_area_center_y = magnify_area_y + magnify_area_height / 2;
        ctx.fillStyle = "rgb(255, 255, 255)";
        ctx.strokeStyle = "rgb(0, 0, 0)";
        ctx.translate(magnify_area_x, magnify_area_center_y);
        ctx.fillRect(0, -magnify_area_height / 2, magnify_area_width, magnify_area_height);
        ctx.strokeRect(0, -magnify_area_height / 2, magnify_area_width, magnify_area_height);
        ctx.drawImage(imgBkGndMagnify, 60, -imgBkGndMagnify.height / 2);
        if (Math.abs(2.25 * delta_msr_percent * zoom_size) < 45)
        {
            ctx.rotate(rotate_angle * delta_msr_percent * zoom_size / 2);
            if (delta_msr_percent == 0)
                ctx.drawImage(imgTailMagnifyRight, 2, - imgTailMagnifyRight.height / 2 - 1);
            else 
                ctx.drawImage(imgTailMagnify, 2, - imgTailMagnify.height / 2 - 1);
            ctx.rotate(-rotate_angle * delta_msr_percent * zoom_size / 2);
        }
        ctx.translate(-magnify_area_x, -magnify_area_center_y);

        // show small scale magnify
        zoom_size = 600;
        magnify_area_x = 530;
        magnify_area_y = -330;
        magnify_area_width = 230;
        magnify_area_height = 80;
        magnify_area_center_x = magnify_area_x + magnify_area_width / 2;
        magnify_area_center_y = magnify_area_y + magnify_area_height / 2;
        ctx.fillStyle = "rgb(255, 255, 255)";
        ctx.strokeStyle = "rgb(0, 0, 0)";
        ctx.translate(magnify_area_x, magnify_area_center_y);
        ctx.fillRect(0, -magnify_area_height / 2, magnify_area_width, magnify_area_height);
        ctx.strokeRect(0, -magnify_area_height / 2, magnify_area_width, magnify_area_height);
        var magnify_scale_cnt = 20;
        var magnify_scale_width = magnify_area_width - 20;
        var magnify_scale_unit = magnify_scale_width / magnify_scale_cnt;
        var magnify_scale_start = Math.min(Math.max(0, small_msr - 10), smallScaleDivisions - magnify_scale_cnt + 2);
        x = 10;
        ctx.fillStyle = "rgb(0, 0, 0)";
        var tick_sign = stgUnit == "lb" ? -1 : 1;
        labelGap = stgUnit == "lb" ? 8 : 10;
        for (var i = magnify_scale_start; i < magnify_scale_start + magnify_scale_cnt; i ++) {
            if (i > smallScaleDivisions) {
                continue;
            }

			if (i % labelGap == 0)
				ticklength = majorTickLengthPixels;
			else if (i % (labelGap / 2) == 0)
				ticklength = (majorTickLengthPixels + minorTickLengthPixels) / 2;
			else
				ticklength = minorTickLengthPixels;
				
            drawLine(x, 0, x, tick_sign * ticklength * 1.5);
            if (i % labelGap == 0) {
                outString(x, -tick_sign * 20, i * (stgUnit == "lb" ? smallLBUnit : smallKGUnit), 1, 0);
            }

            if (i == small_msr) {
                drawLine(x, 0, x + 5, -tick_sign * 5);
                drawLine(x - 5, -tick_sign * 5, x + 5, -tick_sign * 5);
                drawLine(x, 0, x - 5, -tick_sign * 5);
            }
            x += magnify_scale_unit;
        }
        ctx.translate(-magnify_area_x, -magnify_area_center_y);
        
        ctx.font = '14pt sans-serif';
		if (delta_msr_percent == 0) {
			outString(685, -98, "0", 0, 0);
		} else if (delta_msr_percent > 0) {
			outString(685, -98, "+", 0, 0);
		} else if (delta_msr_percent < 0) {
			outString(685, -98, "-", 0, 0);
		}
        
		ctx.rotate(rotate_angle * delta_msr_percent);
		
        ctx.font = '10pt sans-serif';

        ///////draw ruler on main scale

        // ctx.fillRect(0, 0, 20, 20);
		// small scale (top)
        ticklength = 0;
        labelGap = 8;
		x = -330.5 - xDelta, y = -189 - yDelta;
        outString(x - 18, y - 3, "(lb)", 1, 2);
        outString(x - 18, y + 3, "(kg)", 1, 0);
        for (let i = 0; i <= smallScaleLBDivisions; i++){
			if (i % 8 == 0)
				ticklength = majorTickLengthPixels;
			else if (i % 4 == 0)
				ticklength = (majorTickLengthPixels + minorTickLengthPixels) / 2;
			else
				ticklength = minorTickLengthPixels;
				
            drawLine(x, y, x, y - ticklength);
            if (i % labelGap == 0)
				outString(x, (y - majorTickLengthPixels - 3), i * smallLBUnit, 1, 2);
            x += small_lb_pixels;
        }
        labelGap = 10;
		x = -330.5 - xDelta, y = -188 - yDelta;
        for (let i = 0; i <= smallScaleKGDivisions; i++){
			if (i % 10 == 0)
				ticklength = majorTickLengthPixels;
			else if (i % 5 == 0)
				ticklength = (majorTickLengthPixels + minorTickLengthPixels) / 2;
			else
				ticklength = minorTickLengthPixels;
				
            drawLine(x, y, x, y + ticklength);
            if (i % labelGap == 0)
				outString(x, (y + majorTickLengthPixels + 3), i * smallKGUnit, 1, 0);
            x += small_kg_pixels;
        }
		
		// large scale (middle)
        ticklength = 0;
        labelGap = 1;
		x = -252.5 - xDelta, y = -83 - yDelta;
        outString(x - 20, y + 10, "(lb)", 1, 0);
        outString(x - 20, y + 25, "(kg)", 1, 0);
        for (let i = 0; i <= largeScaleLBDivisions + 1; i++){
			if (i % 10 == 0)
				ticklength = majorTickLengthPixels;
			else if (i % 5 == 0)
				ticklength = (majorTickLengthPixels + minorTickLengthPixels) / 2;
			else
				ticklength = minorTickLengthPixels;
            ticklength += 3;
				
            drawLine(x, y, x, y + ticklength);
            if (i % labelGap == 0)
				outString(x, (y + majorTickLengthPixels + 3), (i * largeLBUnit - (i == largeScaleLBDivisions + 1 ? 10 : 0)).toFixed(0), 1, 0);
            if (i == largeScaleLBDivisions) {
                x += large_lb_pixels * 4 / 5;
            } else {
                x += large_lb_pixels;
            }
        }
		x = -252.5 - xDelta, y = -83 - yDelta;
        for (let i = 0; i <= largeScaleKGDivisions; i++){
            if (i == 0) {
                x += large_kg_pixels;
                continue;
            }
			if (i % 10 == 0)
				ticklength = majorTickLengthPixels;
			else if (i % 5 == 0)
				ticklength = (majorTickLengthPixels + minorTickLengthPixels) / 2;
			else
				ticklength = minorTickLengthPixels;
            ticklength += 15;
				
            drawLine(x, y, x, y + ticklength);
            if (i % labelGap == 0)
				outString(x, (y + majorTickLengthPixels + 3 + 15), i * largeKGUnit, 1, 0);
            x += large_kg_pixels;
        }
		
		// small hand
		x = -331.5 + smallShift - xDelta;
		y = -240 - yDelta;
		ctx.drawImage(imgHandSmall, x, y);
		
		// large hand
		x = -253 + largeShift - xDelta;
		y = -110 - yDelta;
		ctx.drawImage(imgHandLarge, x, y);
		
        ctx.restore();

		ctx.fillStyle=fgColor;
        ctx.strokeStyle=fgColor;
		
		ctx.resetTransform();
    }

    

    function drawInfo()
	{
        //draw MSD Info and VSD Info
        ctx.fillStyle = fgColor;
        ctx.strokeStyle = fgColor;
		
        //dra MSD Hint
        let x = scaleOriginX + offsetOriginX - msd_pixels * zeroError / vernierScaleDivisions + getMainScaleReading() * msd_pixels;
        let y = scaleOriginY - majorTickLengthPixels /*+ 43*/;
        let arrowSize = 5;

        //Draw VSD Hint
        let gappixel = msd_pixels * (msr + vsr / vernierScaleDivisions);
        x = scaleOriginX + gappixel + offsetOriginX + getVernierScaleReading() * vsd_pixels;
        y = scaleOriginY + majorTickLengthPixels /*+ 43*/;

        //Draw Screw gauge Reading
        let mr = getMeasuredReading();
        cr = getCorrectedReading();
        let ze = getZeroError();
        x = scaleOriginX - 1;
        y = imgBkGnd.height+5;
        let xs = [scaleOriginX, scaleOriginX - 34, rulerWidthPixel];
        let ys=[imgBkGnd.height + 5, 4, scaleOriginY - 70];
        for(let i = 0; i < 3; i++){
            x = xs[i];
            y = ys[i];
            drawLine(x, y - 8, x, y + 8);
            drawLineWithArrows(x - 30, y, x, y, arrowSize, arrowSize, false, true);
            x += gappixel;
            drawLine(x, y - 8, x, y + 8);
            drawLineWithArrows(x, y, x + 30, y, arrowSize, arrowSize, true, false);
            x -= gappixel / 2;
            y = y + 20;
            if(ze == 0)
			{
				if (i == 1)
					outString(x, y, formatInchValue(cr), 1, 1);
				else
					outString(x, y, formatValue(cr), 1 , 1);
            }
			else if(ze > 0)
			{
                outString(x, y, formatValue(mr) + ' - ' + formatValue(ze) + " = " + formatValue(cr), 1, 1);
            }
			else
			{
                outString(x, y, formatValue(mr) + ' + ' + formatValue(-ze) + " = " + formatValue(cr), 1, 1);
            }
        }
    }


    function getZeroError()
	{
        return (zeroError / vernierScaleDivisions) * msdValue;
    }

	function formatInchValue(s)
	{
		s = s / 2.54;
        return s.toFixed(precision) + "inch";
    }
	
    function formatValue(s)
	{
        return s.toFixed(precision) + unit;
    }
	
    function getMainScaleReading()
	{
        return Math.floor((msr * vernierScaleDivisions + vsr + zeroError) / vernierScaleDivisions);
    }
	
    function getVernierScaleReading()
	{
        return mod(vsr + zeroError, vernierScaleDivisions);
    }
	
    function getMeasuredReading()
	{
        return getCorrectedReading() + getZeroError();
    }
	
    function getCorrectedReading()
	{
        return (msr + vsr / vernierScaleDivisions) * msdValue;
    }
	
    /**
     * returns +ve remainder whn a is divided by n
     * */
    function mod(a,n)
	{
        return ((a % n ) + n ) % n;
    }
	
    function drawLine(x1, y1, x2, y2)
	{
        ctx.beginPath();
        ctx.moveTo(x1, y1);
        ctx.lineTo(x2, y2);
        ctx.stroke();
    }

    // x0,y0: the line's starting point
    // x1,y1: the line's ending point
    // width: the distance the arrowhead perpendicularly extends away from the line
    // height: the distance the arrowhead extends backward from the endpoint
    // arrowStart: true/false directing to draw arrowhead at the line's starting point
    // arrowEnd: true/false directing to draw arrowhead at the line's ending point
    function drawLineWithArrows(x0, y0, x1, y1, aWidth, aLength, arrowStart, arrowEnd)
	{
        var dx = x1 - x0;
        var dy = y1 - y0;
        var angle = Math.atan2(dy, dx);
        var length = Math.sqrt(dx * dx + dy * dy);

		ctx.save();
        ctx.translate(x0, y0);
        ctx.rotate(angle);
        ctx.beginPath();
        ctx.moveTo(0, 0);
        ctx.lineTo(length, 0);
        if(arrowStart)
		{
            ctx.moveTo(aLength, -aWidth);
            ctx.lineTo(0, 0);
            ctx.lineTo(aLength, aWidth);
        }
        if(arrowEnd)
		{
            ctx.moveTo(length - aLength, -aWidth);
            ctx.lineTo(length, 0);
            ctx.lineTo(length - aLength, aWidth);
        }
        
        ctx.stroke();
        ctx.restore();
    }
	
    function outString( x, y, s, x_align, y_align) 
	{
        var fm = ctx.measureText(s);
        var h = 10;//fm.height not supported in browsers
        
		switch (y_align) 
		{
            case 0:
                y += h;
                break;
            case 1:
                y += h / 2;
                break;
            case 2:
                break;
        }
		
        switch (x_align) 
		{
            case 0:
                ctx.fillText(s, x + 3, y);
                break;
            case 1:
                ctx.fillText(s, x - fm.width / 2, y);
                break;
            case 2:
                ctx.fillText(s, x - fm.width / 2, y);
                break;
        }
    }

    function getMousePos(event)
	{
		return [ event.clientX ,event.clientY ];
    }
	
	function getTouchPos(event)
	{
		return [event.touches[0].pageX, event.touches[0].pageY];
	}

    function mousePressed( me) 
	{
        var m;

		if (me.type == 'touchstart')
			m = getTouchPos(me);
		else
			m = getMousePos(me);
		
		var doc = document.documentElement;
		var left = (window.pageXOffset || doc.scrollLeft) - (doc.clientLeft || 0);
		var top = (window.pageYOffset || doc.scrollTop)  - (doc.clientTop || 0);

        //console.log("Pressed");

		var x, y;
		
		if (me.type != 'touchstart')
		{
			//x = (m[0] - canvas.offsetLeft + left) / scale - xOffset; // - canvas.offsetLeft ;
			//y = (m[1] - canvas.offsetTop + top) / scale - yOffset; // - canvas.offsetTop + top ;
			x = (m[0] - canvas.offsetLeft + left) / scale - xOffset; // - canvas.offsetLeft ;
			y = (m[1] - canvas.offsetTop + top) / scale - yOffset; // - canvas.offsetTop + top ;
		}
		else
		{
			//x = (m[0] - canvas.offsetLeft) / scale - xOffset; // - canvas.offsetLeft ;
			//y = (m[1] - canvas.offsetTop) / scale - yOffset; // - canvas.offsetTop + top ;
			x = (m[0] - canvas.offsetLeft) / scale  - xOffset; // - canvas.offsetLeft ;
			y = (m[1] - canvas.offsetTop) / scale - yOffset; // - canvas.offsetTop + top ;
		}
		
        let shift = scaleOriginX + (msr + vsr / vernierScaleDivisions) * msd_pixels;
        var largeShift = large_pixels * large_msr -
                        large_pixels * ((stgUnit == "lb" && large_msr > largeScaleLBDivisions) ? 0.2 : 0);
        var smallShift = small_msr * small_pixels;
		
        var delta_msr_percent = (get_total_msr().toFixed(1) - (randomQuestion ? randomQuestion.toFixed(1) : 0)) / 610;
		var largeDelta = largeShift * Math.tan(delta_msr_percent * rotate_angle);
		var smallDelta = smallShift * Math.tan(delta_msr_percent * rotate_angle);
		
		console.log("-----------------------------")
		console.log("m[0] - offsetLeft = " + (m[0] - canvas.offsetLeft + left));
		console.log("scale = " + scale);
		console.log("x = " + x + ", y = " + y);
		console.log("shift = " + shift);
		console.log("vernierScaleLengthPixels = " + vernierScaleLengthPixels);
		console.log("smallShift = " + smallShift);
		console.log("SmallDelta = " + smallDelta);
		
        // small region
        if(x > (-349 + smallShift) &&
            x < (-245 + smallShift) &&
            y > (-295 + smallDelta/*-135*/) &&
            y < (-138 + smallDelta/*-93*/))
		{
            dragMode = 1;
        }
        // large region
		else if(x > (-250 + largeShift) &&
            x < (-197 + largeShift) &&
            y > (-108 + largeDelta/*-66*/) &&
            y < (-7 + largeDelta/*-23*/))
		{
            dragMode = 2;
        }
        else
        {
            dragMode = 0;
			
			if (y > (72) && y < (109))
			{
				if (x > (-197 + 50 * 10) && x < (-157 + 50 * 10)) {
					set_input_answer("Back");
				} else {
					for (let i = 0; i <= 9; i ++)
					{
						if (x > (-197 + 50 * i) && x < (-157 + 50 * i))
						{
							set_input_answer("" + i);
							break;
						}
					}
				}
			}
        }
		
        paint();
        prev_mx = m[0];
        prev_my = m[1];
        //me.preventDefault();
    }

    function mouseReleased(me) 
	{
        dragMode=0;
    }

    function mouseWheelMoved(me) 
	{
        var scroll = me.wheelDelta > 0 ? 1 : -1;
        // translateVernier(scroll);
        me.preventDefault();
    }

    function mouseDragged( me) 
	{
        if (dragMode == 0) 
			return false;
        
		var m;
		if(me.type == 'touchmove')
			m = getTouchPos(me);
		else 
			m = getMousePos(me);
        
        let dx,dy;
        dx = (m[0] - prev_mx) / scale;
        dy = (m[1] - prev_my) / scale;
        
        // move small scale
		if(dragMode == 1) 
		{
            var delta = parseInt(dx / small_pixels);
            if (delta != 0) {
                set_small_msr(small_msr + delta);
                update();

                prev_mx = m[0];
                prev_my = m[1];
            }
        }
        // move large scale
		else if(dragMode == 2)
		{ 
            var delta = parseInt(dx / large_pixels);
            if (delta != 0) {
                set_large_msr(large_msr + delta);
                update();

                prev_mx = m[0];
                prev_my = m[1];
            }
        }
		
        //me.preventDefault();
    }


    function onKeyEvent(e)
	{
		// console.log(e.keycode);
		if (e.keyCode >= 96/*'0'*/ && e.keyCode <= 105/*'9'*/)  // when using numpad...
		{
			//if (input_answer.length < 10) 
			{
				set_input_answer("" + (e.keyCode - 96));
				update();
			}
		}else if (e.keyCode >= 48/*'0'*/ && e.keyCode <= 57/*'9'*/) {
			//if (input_answer.length < 10) 
			{
				set_input_answer("" + (e.keyCode - 48));
				update();
			}
		} else if (e.keyCode == 8/*BackSpace*/) {
			set_input_answer("Back");
			update();
		} else {
			console.log(e.keyCode);
			return false;
		}
		e.preventDefault();
    }
</script>

<script>
    function toggleNavMenu() {
        var x = document.getElementById("NavMenu");
        if (x.className.indexOf("w3-show") == -1) {  
            x.className += " w3-show";
        } else { 
            x.className = x.className.replace(" w3-show", "");
        }
    }

    function toggleCategory(categoryId) {
        var category = document.getElementById(categoryId);
        if (category.className.indexOf("w3-show") == -1) {  
            category.className += " w3-show";
        } else { 
            category.className = category.className.replace(" w3-show", " w3-hide");
        }
    }
</script>

<script type="text/javascript" async="" src="https://btloader.com/tag?o=5698917485248512&upapi=true&domain=rulergame.net"></script>

<script>!function(){"use strict";var e;e=document,function(){var t,n;function r(){var t=e.createElement("script");t.src="https://cafemedia-com.videoplayerhub.com/galleryplayer.js",e.head.appendChild(t)}function a(){var t=e.cookie.match("(^|[^;]+)\s*__adblocker\s*=\s*([^;]+)");return t&&t.pop()}function c(){clearInterval(n)}return{init:function(){var e;"true"===(t=a())?r():(e=0,n=setInterval((function(){100!==e&&"false" !== t || c(), "true" === t && (r(), c()), t = a(), e++}), 50))}}}().init()}();
</script>
</body>
</html>